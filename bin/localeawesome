#! /usr/bin/env node

var localeawesome = require('../dist/index.js');
var program = require('commander');
var path = require('path');

var conf = {};
var appCfg = require('rc')('localeawesome', conf);

program
  .arguments('<cmd>')
  .action(function (cmd) {
    cmdValue = cmd;
  })
  .command('update', 'To update the compiled default locale (without pushing)')
  .command('push', 'To push to localeapp using the bash command??')
  .command('pull', 'To pull from localeapp and update all files (compiled and src)')
  .parse(process.argv);

if (typeof cmdValue === 'undefined') {
  console.error('no command given!');
  process.exit(1);
}
else {
  if (typeof appCfg[0] === 'undefined') {
    console.error('no config file found!');
    process.exit(1);
  }

  var rootPath = path.resolve('./');
  var localeTarget = appCfg.target;
  var localeSource = appCfg.source;
  var defaultLocale = appCfg.default;

  if (typeof localeTarget === 'undefined'
    || typeof localeSource === 'undefined'
    || typeof defaultLocale === 'undefined') {
    console.error('Missing config options! Provide root, source, default');
    process.exit(1);
  }

  var targetPath = rootPath + localeTarget;
  var sourcePath = rootPath + localeSource;

  localeawesome(cmdValue, sourcePath, targetPath, defaultLocale);
}
